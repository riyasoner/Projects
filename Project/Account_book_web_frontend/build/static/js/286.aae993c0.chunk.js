"use strict";(self.webpackChunkaccount_book_web=self.webpackChunkaccount_book_web||[]).push([[286],{286:(e,t,c)=>{c.r(t),c.d(t,{default:()=>u});var s=c(9379),a=c(5043),n=c(1045),o=c(6140),l=c(965),i=c(4776),r=c(885),d=c(579);const u=function(){const{get:e,del:t,post:c,patch:u}=(0,o.A)(),[m,h]=(0,a.useState)([]),[b,x]=(0,a.useState)(null),[p,j]=(0,a.useState)(""),[g,N]=(0,a.useState)([]),w=async()=>{try{const t=localStorage.getItem("bookId");localStorage.getItem("userId");let c="".concat(l.A.getAllAccounts,"?bookId=").concat(t);""!==p.trim()&&(c+="&search=".concat(p));const s=await e(c);null!==s&&void 0!==s&&s.data?h(s.data):console.warn("No data received from API.")}catch(t){console.error("Error fetching accounts:",t.message||t)}};return(0,a.useEffect)(()=>{w();const e=()=>{w()};return window.addEventListener("selectedBookUpdated",e),()=>{window.removeEventListener("selectedBookUpdated",e)}},[p]),(0,d.jsxs)("div",{className:"container mt-5",children:[(0,d.jsx)("h4",{className:"mb-3",children:"Accounts"}),(0,d.jsxs)("div",{className:"mb-3 position-relative",children:[(0,d.jsx)("input",{type:"text",className:"form-control",placeholder:"Search by name & type",value:p,onChange:t=>{j(t.target.value),(async t=>{try{if(!t.trim())return void N([]);const c=localStorage.getItem("bookId"),s=localStorage.getItem("userId"),a="".concat(l.A.accountSuggestions,"?bookId=").concat(c,"&userId=").concat(s,"&search=").concat(t),n=await e(a);null!==n&&void 0!==n&&n.status&&n.data?N(n.data):N([])}catch(c){console.error("Error fetching suggestions:",c.message||c)}})(t.target.value)}}),g.length>0&&(0,d.jsx)("ul",{className:"list-group position-absolute shadow",style:{zIndex:1e3,maxHeight:"200px",overflowY:"auto",width:"300px"},children:g.map(e=>(0,d.jsxs)("li",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",style:{cursor:"pointer"},onClick:()=>{j(e.name),N([]),w()},children:[(0,d.jsx)("span",{children:e.name}),(0,d.jsxs)("small",{className:"text-muted",children:["(",e.account_type,")"]})]},e.id))})]}),(0,d.jsx)("div",{className:"d-flex justify-content-end mb-3",children:(0,d.jsxs)(n.N_,{to:"/new-account",className:"btn text-white",style:{background:"#019ED3"},children:[(0,d.jsx)("i",{className:"bi bi-plus-circle me-2"})," Add New Account"]})}),(0,d.jsxs)("table",{className:"table table-striped table-bordered",children:[(0,d.jsx)("thead",{className:"table-primary",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{scope:"col",children:"Account Type"}),(0,d.jsx)("th",{scope:"col",children:"Account Name"}),(0,d.jsx)("th",{scope:"col",children:"Description"}),(0,d.jsx)("th",{scope:"col",children:"Balance"}),(0,d.jsx)("th",{scope:"col",children:"Actions"})]})}),(0,d.jsx)("tbody",{children:m.length>0?m.map(e=>e.accounts.map(e=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{children:e.account_type}),(0,d.jsx)("td",{children:(0,d.jsx)(n.N_,{to:"/account/".concat((0,r.r)(e.id)),state:{account:e},children:e.name})}),(0,d.jsx)("td",{children:e.description}),(0,d.jsxs)("td",{className:e.balance<0?"text-danger":"text-success",children:[e.balance," \u20b9"]}),(0,d.jsxs)("td",{children:[(0,d.jsx)("button",{className:"btn btn-outline-primary btn-sm me-2",onClick:()=>x(e),title:"Edit Account",children:(0,d.jsx)("i",{className:"bi bi-pencil"})}),(0,d.jsx)("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this account?"))try{localStorage.getItem("bookId");const c="".concat(l.A.deleteAccount,"/").concat(e),a=await t(c);null!==a&&void 0!==a&&a.status?h(t=>t.map(t=>(0,s.A)((0,s.A)({},t),{},{accounts:t.accounts.filter(t=>t.id!==e)}))):console.warn("Failed to delete account.")}catch(c){console.error("Error deleting account:",c.message||c)}})(e.id),title:"Delete Account",children:(0,d.jsx)("i",{className:"bi bi-trash"})})]})]},e.id))):(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:"5",className:"text-center",children:"No accounts available"})})})]}),b&&(0,d.jsx)("div",{className:"modal d-block",tabIndex:"-1",style:{background:"rgba(0,0,0,0.5)"},children:(0,d.jsx)("div",{className:"modal-dialog modal-lg",children:(0,d.jsxs)("div",{className:"modal-content p-3",children:[(0,d.jsx)("button",{className:"btn btn-sm btn-close ms-auto",onClick:()=>x(null)}),(0,d.jsx)(i.A,{account:b,onSuccess:()=>{x(null),w()}})]})})})]})}}}]);
//# sourceMappingURL=286.aae993c0.chunk.js.map